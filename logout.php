<?php
// logout.php (FINAL, RELIABLE VERSION)

// Шаг 1: Начинаем или возобновляем сессию.
// Это самый важный шаг. Мы не можем уничтожить то, к чему не имеем доступа.
if (session_status() === PHP_SESSION_NONE) {
    session_start();
}

// Шаг 2: Очищаем все данные из сессии.
// Это удаляет все переменные, такие как $_SESSION['user_id'].
session_unset();

// Шаг 3: Уничтожаем саму сессию на сервере.
// Это делает невалидным идентификатор сессии.
session_destroy();

// Шаг 4: Теперь, когда пользователь гарантированно "забыт",
// перенаправляем его на главную страницу.
// index.php теперь не найдет сессию и покажет страницу для гостя.
header("Location: index.php");
exit(); // Всегда вызываем exit() после редиректа.

?>